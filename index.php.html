<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=3.0, user-scalable=yes">
  <title id="title">分期付</title>
  <link rel="stylesheet" href="resources/css/layui.css.html" />
  <link rel="stylesheet" href="resources/css/risk-notice.css.html" />
  <link rel="stylesheet" href="resources/css/compatibility.css.html" />
  <script src="resources/js/layui.js.html"></script>
  <script src="resources/js/axios.min.js.html"></script>
  <script src="resources/js/compatibility.js.html"></script>
  <style>
    body {
      margin: 0;
      background: #f2f2f2;
      padding-bottom: 0 !important; /* 风险提示标签已隐藏，恢复正常间距 */
      font-size: 16px;
    }
    
    /* 加载动画样式 */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #f2f2f2;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.5s ease-out;
    }
    
    .loading-circle {
      width: 50px;
      height: 50px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #1890ff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }
    
    .loading-text {
      color: #666;
      font-size: 16px;
      font-weight: 500;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* 内容区域初始隐藏 */
    .main-content {
      opacity: 0;
      transition: opacity 0.5s ease-in;
    }
    
    .main-content.loaded {
      opacity: 1;
    }

    img {
      max-width: 100%;
      height: auto;
      display: block;
    }

    .hero-box {
      background: #429ff1;
      color: white;
      border-bottom-left-radius: 5vw;
      border-bottom-right-radius: 5vw;
      padding: 5vw;
      text-align: center;
    }

    .hero-box .limit {
      font-size: 2.2rem;
      font-weight: bold;
    }

    .login-button {
      display: inline-block;
      background: linear-gradient(to right, #00cc88, #00aa66);
      color: #fff;
      font-size: 1rem;
      font-weight: bold;
      padding: 0.75rem 2.5rem;
      border-radius: 40px;
      margin-top: 1rem;
      text-decoration: none;
      box-shadow: 0 4px 10px rgba(0, 204, 136, 0.3);
      transition: 0.3s;
      cursor: pointer;
    }
    .login-button:hover {
      background: linear-gradient(to right, #00aa66, #008855);
    }

    .marquee-box {
      background: #fff7f0;
      color: #e64a19;
      font-weight: bold;
      padding: 10px;
      margin-top: 10px;
      text-align: center;
    }

    .step-box {
      background: #fff;
      padding: 15px 10px;
      margin-top: 10px;
      font-size: 0.9rem;
    }

    .product-card {
      margin-top: 10px;
      font-size: 0.95rem;
    }

    .footer-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      width: 100%;
      height: 80px;
      background: #fff;
      display: flex;
      border-top: 1px solid #eee;
      z-index: 100;
      box-sizing: border-box;
      max-width: 100vw;
      overflow: hidden;
    }

    .footer-nav .nav-item {
      flex: 1;
      text-align: center;
      padding: 10px 6px 8px 6px;
      font-size: 0.9rem;
      color: #666;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-width: 0;
      box-sizing: border-box;
    }

    .footer-nav .nav-item i {
      font-size: 1.6rem;
      display: block;
      margin-bottom: 4px;
      line-height: 1;
    }

    .footer-nav .nav-item div {
      font-size: 0.8rem;
      line-height: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 100%;
    }

    .footer-nav .active {
      color: #00B7EE;
    }

    .layui-card-header {
      font-weight: bold;
    }

    /* 底部风险提示样式 - 隐藏标签，只显示文字内容 */
    .risk-notice {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: transparent; /* 隐藏背景 */
      border: none; /* 移除边框 */
      box-shadow: none; /* 移除阴影 */
      z-index: 1000;
      padding: 12px 16px;
      display: none; /* 完全隐藏整个标签容器 */
    }

    .risk-content {
      max-width: 1200px;
      margin: 0 auto;
      text-align: center;
    }

    .risk-text {
      font-size: 13px;
      color: #666;
      margin-bottom: 4px;
      line-height: 1.4;
    }

    .risk-text strong {
      color: #333;
      font-weight: 600;
    }

    .company-info {
      font-size: 11px;
      color: #999;
      line-height: 1.3;
    }

    /* 调整页面底部间距，为底部导航留出空间 */
    body {
      padding-bottom: 90px !important; /* 为更大的底部导航留出空间 */
    }
    
    .main-content {
      padding-bottom: 20px;
    }
    
    /* 移动端适配 */
    @media (max-width: 480px) {
      .footer-nav .nav-item {
        padding: 8px 4px 6px 4px;
        font-size: 0.8rem;
      }
      
      .footer-nav .nav-item i {
        font-size: 1.4rem;
      }
      
      .footer-nav .nav-item div {
        font-size: 0.7rem;
      }
      
      .footer-nav {
        height: 75px;
      }
      
      body {
        padding-bottom: 85px !important;
      }
    }
    
    @media (max-width: 360px) {
      .footer-nav .nav-item {
        padding: 6px 3px 4px 3px;
      }
      
      .footer-nav .nav-item i {
        font-size: 1.2rem;
      }
      
      .footer-nav .nav-item div {
        font-size: 0.65rem;
      }
      
      .footer-nav {
        height: 70px;
      }
      
      body {
        padding-bottom: 80px !important;
      }
    }
  </style>
</head>
<body>
  <!-- 加载动画覆盖层 -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-circle"></div>
    <div class="loading-text">正在加载中...</div>
  </div>
  
  <!-- 主要内容区域 -->
  <div class="main-content" id="mainContent">
  <div class="layui-container" style="text-align: center; padding: 5vw 0 3vw;">
    <h2 style="font-size: 1.5rem;" id="page_title">加载中...</h2>
    <p class="layui-text" id="subtitle">加载中...</p>
  </div>
  
  <div class="hero-box">
    <img src="resources/images/cute.webp.html" alt="企鹅图" style="max-width: 100%; max-height: 160px; margin: 0 auto; display: block;">
    <div style="font-size: 1.2rem; font-weight: bold;" id="welcome_text">加载中...</div>
    <div style="margin-top: 5px; font-size: 0.9rem;" id="amount_label">加载中...</div>
    <div class="limit" id="amount_value">加载中...</div>
    <div style="font-size: 0.9rem;" id="rate_label">加载中...</div>
    <a href="login.php" class="login-button" id="login_btn_text">加载中...</a>
    <p style="margin-top: 10px; font-size: 0.75rem;" id="tip_text">加载中...</p>
  </div>

  <div class="marquee-box" id="marquee">
    <span id="marquee_text">加载中...</span>
  </div>

  <div class="layui-row layui-col-space10 step-box" style="display: flex; justify-content: center; align-items: center; flex-wrap: nowrap;">
    <!-- Step 1 -->
    <div style="text-align:center;">
      <img src="resources/images/step-1.webp.html" alt="申请服务" style="width:48px;height:48px;margin:auto;">
      <p id="step1_text">加载中...</p>
    </div>
  
    <!-- Arrow 1 -->
    <div style="padding: 0 5px;">
      <img src="resources/images/zb.png.html" alt="箭头" style="width:24px;height:auto;">
    </div>
  
    <!-- Step 2 -->
    <div style="text-align:center;">
      <img src="resources/images/step-2.webp.html" alt="最快审批" style="width:48px;height:48px;margin:auto;">
      <p id="step2_text">加载中...</p>
    </div>
  
    <!-- Arrow 2 -->
    <div style="padding: 0 5px;">
      <img src="resources/images/zb.png.html" alt="箭头" style="width:24px;height:auto;">
    </div>
  
    <!-- Step 3 -->
    <div style="text-align:center;">
      <img src="resources/images/step-3.webp.html" alt="最快处理" style="width:48px;height:48px;margin:auto;">
      <p id="step3_text">加载中...</p>
    </div>
  </div>
  

  <div class="layui-card product-card layui-container">
    <div class="layui-card-header" id="product_title">加载中...</div>
    <div class="layui-card-body">
      <table class="layui-table" lay-size="sm">
        <tbody>
          <tr><td>服务费率</td><td id="rate_info">加载中...</td></tr>
          <tr><td>最高额度</td><td id="max_amount">加载中...</td></tr>
          <tr><td>计费方式</td><td id="payment_method">加载中...</td></tr>
          <tr><td>处理方式</td><td id="process_method">加载中...</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="layui-container" style="margin-top:20px;">
    <div class="layui-card">
      <div class="layui-card-header" style="text-align:center; font-size:1.1rem;" id="cooperation_title">加载中...</div>
      <div class="layui-card-body" style="text-align:center;">
        <div class="layui-row layui-col-space10">
          <div class="layui-col-xs4" id="bank_count">加载中...</div>
          <div class="layui-col-xs4" id="insurance_count">加载中...</div>
          <div class="layui-col-xs4" id="finance_count">加载中...</div>
        </div>
        <div style="margin-top:15px;">
          <img src="resources/images/cooperation.webp.html" alt="合作机构">
        </div>
      </div>
    </div>
  </div>

  <div class="footer-nav">
    <div class="nav-item active" onclick="window.location.href='user.php';">
      <i class="layui-icon layui-icon-home"></i>
      <div>首页</div>
    </div>
    <div class="nav-item" onclick="window.location.href='chatlink.php';">
      <i class="layui-icon layui-icon-dialogue"></i>
      <div>客服</div>
    </div>
    <div class="nav-item" onclick="window.location.href='repayment.php';">
      <i class="layui-icon layui-icon-rmb"></i>
      <div>欠款</div>
    </div>
    <div class="nav-item" onclick="window.location.href='profile.php';">
      <i class="layui-icon layui-icon-username"></i>
      <div>我的</div>
    </div>
  </div>

  <!-- 底部风险提示 -->
  <div class="risk-notice">
    <div class="risk-content">
      <div class="risk-text">
        <strong>风险提示：</strong> 本站仅作信息展示，不提供任何借贷服务。借款请通过持牌机构。
      </div>
      <div class="company-info">
        公司：<span id="company_name">分期付网络贷款有限公司</span> | 电话：400-888-8888 | ICP：京ICP备2024000000号
      </div>
    </div>
  </div>
  </div> <!-- 关闭 main-content -->

  <script src="resources/js/main.js.html"></script>
  <script>
    // 页面加载完成后加载数据
    document.addEventListener('DOMContentLoaded', function() {
      // 先检查本地登录状态，快速判断
      if (checkLoginStatus(false)) {
        // 本地有登录信息，异步检查服务端，同时开始加载
      syncLoginWithServer().then(function(loggedIn){
          if (loggedIn) {
          window.location.href = 'user.php';
          return;
        }
        }).catch(function() {
          // 检查失败不影响页面加载
        });
      }
      
      // 立即开始加载数据，不等待登录检查
        startLoadingProcess();
    });
    
    // 开始加载流程 - 优化版本
    function startLoadingProcess() {
      // 更新加载文字
      updateLoadingText('正在加载...');
      
      // 备用机制：最多3秒后强制显示内容
      var forceShowTimeout = setTimeout(function() {
        hideLoadingAndShowContent();
      }, 3000);
      
      // 使用原来的loadPageData函数加载数据
      loadPageData('index').then(function(data) {
        clearTimeout(forceShowTimeout); // 清除强制显示定时器
        
        // 立即显示内容，移除不必要的延迟
          hideLoadingAndShowContent();
        
      }).catch(function(error) {
        clearTimeout(forceShowTimeout); // 清除强制显示定时器
        // 即使失败也要显示内容
          hideLoadingAndShowContent();
      });
    }
    
    
    // 更新加载文字
    function updateLoadingText(text) {
      var loadingText = document.querySelector('.loading-text');
      if (loadingText) {
        loadingText.textContent = text;
      }
    }
    
    
    // 隐藏加载动画并显示内容
    function hideLoadingAndShowContent() {
      var loadingOverlay = document.getElementById('loadingOverlay');
      var mainContent = document.getElementById('mainContent');
      
      if (loadingOverlay && mainContent) {
        // 淡出加载动画
        loadingOverlay.style.opacity = '0';
        
        // 快速移除加载层并显示内容（减少延迟）
        setTimeout(function() {
          loadingOverlay.style.display = 'none';
          mainContent.classList.add('loaded');
        }, 200); // 减少延迟到200ms
      }
    }
  </script>
  
</body>
</html>
